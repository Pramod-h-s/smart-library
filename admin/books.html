<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Books Manager - Smart Library</title>
  <link rel="stylesheet" href="../css/styles.css">
</head>

<body>
<div id="admin-app">

  <!-- SIDEBAR -->
  <aside class="admin-sidebar glass-card">
    <div class="sidebar-header">
      <img src="../assets/cbit-logo.jpg" alt="Admin Logo">
      <h2>Admin Panel</h2>
    </div>

    <nav class="sidebar-nav">
      <a href="dashboard.html" class="nav-link">Dashboard</a>
      <a href="books.html" class="nav-link active">Books Manager</a>
      <a href="transactions.html" class="nav-link">Transactions</a>
      <a href="issue-return.html" class="nav-link">Issue/Return</a>

      <button id="logoutBtn" class="nav-link logout-btn">
        Logout
      </button>
    </nav>
  </aside>

  <!-- MAIN -->
  <main class="admin-main">

    <header class="admin-header glass-card">
      <h1>Books Manager</h1>

      <div class="header-actions">
        <button id="addBookBtn" class="btn-primary">Add Book</button>
        <button id="importBtn" class="btn-success">Import CSV</button>
        <button id="exportBtn" class="btn-warning">Export CSV</button>
      </div>
    </header>

    <section class="admin-content">
      <table class="data-table">
        <thead>
          <tr>
            <th>Title</th>
            <th>Author</th>
            <th>Quantity</th>
          </tr>
        </thead>
        <tbody id="booksTableBody">
          <tr><td colspan="3">Loading...</td></tr>
        </tbody>
      </table>
    </section>

  </main>
</div>

<!-- MODAL -->
<div id="bookModal" class="modal" style="display:none">
  <div class="modal-content glass-card">
    <form id="bookForm">
      <input id="bookTitle" placeholder="Title" required>
      <input id="bookAuthor" placeholder="Author" required>
      <input id="bookISBN" placeholder="ISBN">
      <input id="bookCategory" placeholder="Category" required>
      <input id="bookQuantity" type="number" placeholder="Quantity" required>
      <input id="bookCover" placeholder="Cover URL">
      <button type="submit">Save Book</button>
    </form>
  </div>
</div>

<!-- âœ… ONLY ONE SCRIPT BLOCK -->
<script type="module">
  import { protectPage, logoutUser } from "../js/auth-check.js";
  import { Admin } from "../js/admin.js";

  protectPage("admin");

  document.getElementById("logoutBtn").onclick = logoutUser;
  document.getElementById("addBookBtn").onclick = () =>
    document.getElementById("bookModal").style.display = "flex";

  document.getElementById("importBtn").onclick = Admin.books.importCSV;
  document.getElementById("exportBtn").onclick = Admin.books.exportCSV;

  Admin.books.init();
</script>

</body>
</html>
